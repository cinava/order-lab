
<script language="Javascript">


    $(document).ready(function() {

        showHideWell('.fellapp-ecfmgcertificate-field');
        showHideWell('.fellapp-reprimand-field');
        showHideWell('.fellapp-lawsuit-field');

        $('.textarea').bind('keydown keyup keypress cut copy past blur change', function(){
            copy_to_print_helper(this); // consider debouncing this to avoid slowdowns!
        });

        $('textarea').each(function(){
            copy_to_print_helper(this); // on initial page load
        });


        //Training period for which applying
        var now = new Date();
        $(".fellapp-startDate").datepicker().datepicker("setDate", new Date(now.getFullYear()+2,6,1));
        $(".fellapp-endDate").datepicker().datepicker("setDate", new Date(now.getFullYear()+3,5,30 ));


    });

    //http://stackoverflow.com/questions/4435906/print-when-textarea-has-overflow
    function copy_to_print_helper(element){
        var print_helper = $(element).closest('.well').find('.print_helper');
        if( print_helper ) {
            print_helper.text($(element).val());
        }
    }

    function hideWell(element) {
        var delaytime = 500;
        if( cycle == 'download' ) {
            delaytime = 0;
        }
        $(element).closest('.form-element-holder').find('.wellcollapsable').hide(delaytime); //500
        $(element).closest('.form-element-holder').find('.wellcollapsable').find('input,textarea').val('');
        //resetUploadBtn($(element).closest('.form-element-holder').find('.wellcollapsable'));
    }

    function showWell(element) {
        var delaytime = 500;
        if( cycle == 'download' ) {
            delaytime = 0;
        }
        $(element).closest('.form-element-holder').find('.wellcollapsable').show(delaytime); //500
    }

    function showHideWell(element) {

        //console.log('showHideWell');

        if( $(element).is(':checked') ) {
            //console.log('checked');
            showWell(element);
        } else {
            //console.log('not checked');
            hideWell(element);
        }

        //listener
        $(element).click( function() {
            showHideWell(this);
        });
    }


    function validateFellapp() {

        $('#error-box').hide();

        var error = null;

        //required: fellowshipSubspecialty
        var fellowshipSubspecialty = $('.fellapp-fellowshipSubspecialty').first().select2('val');
        //console.log('fellowshipSubspecialty=('+fellowshipSubspecialty+')');
        if( !error && !fellowshipSubspecialty ) {
            error = "Please select in the Fellowship Type before uploading";
        }

        var startDate = $('.fellapp-startDate').first().val();
        //console.log('startDate=('+startDate+')');
        if( !error && !startDate ) {
            error = "Please fill in the Start Date before uploading";
        }

        //required: user-firstName
        var endDate = $('.fellapp-endDate').first().first().val();
        if( !error && !endDate ) {
            error = "Please fill in the End Date before uploading";
        }

        //required: user-firstName
        var firstName = $('.user-firstName').first().val();
        if( !error && !firstName ) {
            error = "Please fill in the First Name before uploading";
        }

        //required: user-lastName
        var lastName = $('.user-lastName').first().val();
        if( !error && !lastName ) {
            error = "Please fill in the Last Name before uploading";
        }

        //required: user-email
        var email = $('.user-email').first().val();
        if( !error && !email ) {
            error = "Please fill in the email before uploading";
        }

        //console.log('error='+error);

        if( error ) {
            $('#error-box').html(error);
            $('#error-box').show();
            return false;
        }

        $('#fellapp-applicant-form').submit();
    }


//    function updateFellapp(fellappId) {
//
//        //first update report
//        //TODO: use messaging
//        updateFellAppReport(fellappId);
//
//        //submit form
//        $('#fellapp-applicant-form').submit();
//    }
//
//    //TODO: use messaging
//    function updateFellAppReport(fellappId) {
//        var url = Routing.generate('fellapp_update_report');
//
//        //var fellappId = $('#fellapp_id').val();
//        //console.log('fellappId='+fellappId);
//
//        $.ajax({
//            type: "POST",
//            url: url,
//            timeout: _ajaxTimeout,
//            async: true,
//            data: {id: fellappId}
//        }).success(function(data) {
//            //console.log('data='+data);
//        }).fail(function(data) {
//            console.log('fellapp update report failed: '+data);
//        });
//    }

</script>


