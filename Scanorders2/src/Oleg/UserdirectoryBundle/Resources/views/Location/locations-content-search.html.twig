
{% import "OlegUserdirectoryBundle::Default/usermacros.html.twig" as usermacros %}

{% if search is defined and search != "" %}
    <h3 class="text-info">
        {#Results of Location search for: "{{ search }}" of the#}
        Common Locations
    </h3>
{% endif %}

<table class="records_list table table-hover table-condensed text-left">
    <thead>
    <tr>
        {#<th style="display:none">{{ knp_pagination_sortable(locations, 'ID', 'location.id') }}</th>#}
        <th>{{ knp_pagination_sortable(locations, 'Name', 'location.name') }}</th>
        <th>{{ knp_pagination_sortable(locations, 'Phone', 'location.phone') }}</th>
        <th>{{ knp_pagination_sortable(locations, 'IC', 'location.ic') }}</th>
        <th>{{ knp_pagination_sortable(locations, 'Fax', 'location.fax') }}</th>
        <th>{{ knp_pagination_sortable(locations, 'Room', 'locationroom.name') }}</th>
        {#<th>{{ knp_pagination_sortable(locations, 'Supervisor', 'headsinfos.displayName') }}</th>#}
        <th>{{ knp_pagination_sortable(locations, 'Supervisor', 'administrativeTitleUser.displayName') }}</th>
    </tr>
    </thead>
    <tbody data-link="row" class="rowlink">
    {% for entity in locations %}
        <tr>
            {#<td style="display:none"><a href="{{ path(sitename~'_locations_pathaction_show_standalone', { 'id': entity.id }) }}">{{ entity.id }}</a></td>#}
            <td>
                <a href="{{ path(sitename~'_locations_pathaction_show_standalone', { 'id': entity.id }) }}">{{ entity.getNameFull(true)|raw }}</a>
            </td>
            <td class="rowlink-skip">
                {{ usermacros.phoneHref(entity.phone) }}
            </td>
            <td>{{ entity.ic }}</td>
            <td>{{ entity.fax }}</td>
            <td class="rowlink-skip">
                {#{{ entity.room }}#}
                <a href="{{ path( employees_sitename~'_search_same_object', { 'tablename':'room','id': entity.room.id, 'name': entity.room.name }) }}">{{ entity.room }}</a>
            </td>
            <td class="rowlink-skip">
                {#{% if entity.service %}#}
                    {#{% for head in entity.service.heads %}#}
                        {#<p><a href="{{ path(sitename~'_showuser', { 'id': head.id }) }}">{{ head.getUsernameShortest() }}</a></p>#}
                    {#{% endfor %}#}
                {#{% endif %}#}

                {#TODO: implement this: show supervisers of this location#}
                {% if entity.institution %}
                    {#institution:{{ entity.institution.name }}#}
                    {% for administrativeTitle in entity.institution.administrativeTitles %}
                        {#users|length:{{ users|length }}#}
                        {#{% for user in users %}#}
                            {#{% for administrativeTitle in user.administrativeTitles %}#}
                                {#{% for userPosition in administrativeTitle.userPositions %}#}
                                    <p><a href="{{ path(sitename~'_showuser', { 'id': user.id }) }}">{{ administrativeTitle.user.getUsernameShortest() }} {{ administrativeTitle.userPosition.getName() }}</a></p>
                                {#{% endfor %}#}
                            {#{% endfor %}#}
                        {#{% endfor %}#}
                    {% endfor %}
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>


<div class="navigation">
    {{ knp_pagination_render(locations) }}
</div>

