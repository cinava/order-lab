<!DOCTYPE html>

<html>

    <head>

        {% stylesheets
            'bundles/oleguserdirectory/bootstrap/css/*' filter='cssrewrite'
            'bundles/oleguserdirectory/form/css/form.css' filter='cssrewrite'
            'bundles/oleguserdirectory/select2/select2.css' filter='cssrewrite'
        %}
            <link rel="stylesheet" type="text/css" media="screen" href="{{ asset_url }}" />
        {% endstylesheets %}

        {% set favicon = 'favicon.ico' %}

        {% if sitename == employees_sitename %}
            {% set title = "Employee Directory" %}
            {% set favicon = 'bundles/oleguserdirectory/form/img/users-1-64x64.png' %}
        {% endif %}

        {% if sitename == scan_sitename %}
            {% set title = "Scan Orders" %}
            {% set favicon = 'favicon.ico' %}
        {% endif %}

        {% if sitename == fellapp_sitename %}
            {% set title = "Fellowship Applications" %}
            {% set favicon = 'glyphicons-37-file.png' %}
        {% endif %}

        {% if sitename == deidentifier_sitename %}
            {% set title = "Deidentifier" %}
            {% set favicon = 'glyphicons-81-retweet.png' %}
        {% endif %}

        {% if sitename == vacreq_sitename %}
            {% set title = "Vacation Request" %}
            {% set favicon = 'glyphicons-39-plane.png' %}
        {% endif %}

        {% if sitename == calllog_sitename %}
            {% set title = "Call Log Book" %}
            {% set favicon = 'glyphicons-442-phone-alt.png' %}
        {% endif %}

        <title>{{ title }}</title>

        {#<meta name="viewport" content="width=device-width, initial-scale=1.0">#}

        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        {#<meta name = "viewport" content = "user-scalable=no, initial-scale=1.0, maximum-scale=1.0, width=device-width"/>#}
        {#<meta name="apple-mobile-web-app-capable" content="yes"/>#}

        {% import "OlegUserdirectoryBundle::Default/usermacros.html.twig" as usermacros %}
        {{ usermacros.nonLiveSiteRedirect() }}

        <link rel="icon" type="image/x-icon" href="{{ asset(favicon) }}" />

    </head>

    <body>

        <div class="container text-center">

            <input type="hidden" id="baseurl" value="{{app.request.host}}{{app.request.getBaseURL()}}" />

            {% include 'OlegUserdirectoryBundle::Security/login_content.html.twig' with {'sitename': sitename, 'title': title} %}

            {% include 'OlegUserdirectoryBundle::Default/footer.html.twig' %}

        </div> <!-- /container -->

        {% javascripts
        '@OlegUserdirectoryBundle/Resources/public/jquery/jquery-1.11.0.min.js'
        '@OlegUserdirectoryBundle/Resources/public/bootstrap/js/*'
        '@OlegUserdirectoryBundle/Resources/public/select2/select2.js'
        '@OlegUserdirectoryBundle/Resources/public/form/js/user-common.js'
        %}
        <script type="text/javascript" src="{{ asset_url }}"></script>
        {% endjavascripts %}


        <script type="text/javascript">
            var _ajaxTimeout = 60000;  //15000 => 15 sec
            //var urlBase = $("#baseurl").val();
            var url = getCommonBaseUrl("setloginvisit/");	//urlBase+"setloginvisit/";
            //console.log("url="+url);

            $(document).ready(function() {

                regularCombobox();

                $("#login-form").on("submit", function () {
                    setFullUsername();
                    //alert("username="+document.getElementById("username").value + ", password=" + document.getElementById("password").value );
                    return true;
                });

                //cursor would only be moved to the password field if the user name is non-empty
                if( $('#display-username').val() ) {
                    //console.log('focus password field');
                    $('#password').focus();
                } else {
                    //console.log('focus username field');
                    $('#display-username').focus();
                }

                $.ajax({
                    url: url,
                    type: 'GET',
                    async: true,
                    timeout: _ajaxTimeout,
                    data: { display_height: screen.height, display_width: screen.width },
                    success: function (data) {
                        //console.debug('send browser data ok');
                    },
                    error: function (x , t, m) {
                        if( t === "timeout" ) {
                            getAjaxTimeoutMsg();
                        }
                        //console.debug('send browser data error');
                    }
                });

            });

            //append usernametype to username
            function setFullUsername() {

                var usertypeAbbreviation = $('#usernametypeid_show').select2('val');
                if( !usertypeAbbreviation || usertypeAbbreviation == "" || usertypeAbbreviation === null || typeof usertypeAbbreviation === 'object' ) {
                    //return;
                    usertypeAbbreviation = 'wcmc-cwid';
                }

                //console.log(usertypeAbbreviation);
                //alert(usertypeAbbreviation);

                var username = $('#display-username').val();
                if( !username || username == "" ) {
                    return;
                }

                var fullusername = username + "_@_" + usertypeAbbreviation;

                //console.log("usertypeAbbreviation="+usertypeAbbreviation+", fullusername="+fullusername);

                $('#username').val(fullusername);

                return;
            }






        </script>


    </body>
         
</html>