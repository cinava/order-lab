{% extends "OlegUserdirectoryBundle::Default/base.html.twig" %}

{% block additionaljs %}
    {% javascripts
    '@OlegUserdirectoryBundle/Resources/public/typeahead/typeahead.bundle.js'
    '@OlegUserdirectoryBundle/Resources/public/form/js/user-typeahead.js'
    %}
    <script type="text/javascript" src="{{ asset_url }}"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            initTypeaheadSerach();
        });
    </script>

    {% endjavascripts %}
{% endblock %}

{% block title %}
    Employee Directory
{% endblock %}


{% block additionalcss %}
    {% stylesheets
    'bundles/oleguserdirectory/form/css/typeahead.css' filter='cssrewrite'
    %}
    <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}
{% endblock %}



{% block content %}

    <div style="margin-top:25px;">

        {#class="well form-search"#}
        <form action="{{ path(employees_sitename~'_home') }}" method="get">
            <div class="row">
                <div class="col-xs-10">
                    <input type="text" class="form-control limit-font-size submit-on-enter-field" name="search" id="user_search" value="{{ search }}">
                </div>
                <div class="col-xs-2">
                    <div class="btn-group btn-group-justified">
                        <div class="btn-group">
                            <button type="submit" class="btn btn-sm btn-default order-filter-btn"><i class="icon-search"></i>Search</button>
                        </div>
                    </div>
                </div>
            </div>

        </form>

        <br><br>

        <form action="{{ path(employees_sitename~'_home') }}" method="get">
            <div class="row">
                <div class="col-xs-12">
                    <div id="multiple-datasets-typeahead-search">
                        <input type="text" class="typeahead submit-on-enter-field" name="search" id="user_search" value="{{ search }}" placeholder="Employees Search">
                    </div>
                </div>
            </div>
        </form>


        {% if entities and entities|length > 0 %}
            {% include 'OlegUserdirectoryBundle::Admin/users-content.html.twig' with {'sitename': employees_sitename} %}
        {% endif %}


    </div>

    {#<div class="row">#}
        {#<div class="col-xs-12">#}
            {#<div id="multiple-datasets-typeahead-search">#}
                {#<input class="typeahead submit-on-enter-field" type="text" placeholder="Preferred Display Name / Administrative Title">#}
            {#</div>#}
        {#</div>#}
    {#</div>#}


{% endblock %}



{% block contentleft %}

    {% if entities is not defined or entities|length == 0 %}

        <div style="margin-top:25px;">

            <p>
                Welcome to the Employee Directory!
            </p>

            {% if app.security.getToken().getUser.getEmail == "" %}
                <p>
                    If you would like to receive email notifications regarding your orders, please take a moment to update
                    <a href="{{ path(employees_sitename~'_showuser', { 'id': app.security.getToken().getUser.getId }) }}">your profile</a>
                    by adding your email account.
                </p>
            {% endif %}


            <p>
                Please review and update your <a href="{{ path(employees_sitename~'_showuser', { 'id': app.security.getToken().getUser.getId }) }}">profile</a>.
            </p>


            <br>

            <p>

                {% if is_granted('ROLE_USERDIRECTORY_ADMIN') %}

                    {% set pendingadminreview = render(controller("OlegUserdirectoryBundle:User:pendingAdminReview")) %}

                    There are:

                    <ul>

                        <li>
                            <a href="{{ path(employees_sitename~'_accessrequest_list') }}">{{ accessreqs }} unprocessed access request(s)</a>
                        </li>

                        <li>
                            <a href="{{ path(employees_sitename~'_listusers',{'filter': 'Pending Administrative Review'}) }}">{{ pendingadminreview }} user profile(s) with data pending administrative review and approval</a>
                        </li>

                    </ul>

                {% endif %}

            </p>


        </div>

    {% endif %}

{% endblock %}

