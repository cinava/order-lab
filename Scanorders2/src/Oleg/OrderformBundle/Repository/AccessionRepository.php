<?php

namespace Oleg\OrderformBundle\Repository;
use Doctrine\ORM\EntityRepository;

use Oleg\OrderformBundle\Entity\Accession;

/**
 * AccessionRepository
 * This class was generated by the Doctrine ORM.
 * Add your own custom repository methods below.
 */
class AccessionRepository extends EntityRepository {
    
    //this function will create an accession if it doesn't exist or return the existing accession object
    public function processAccession( $accession ) { 
        
        $entity = $this->findOneBy(array('accession' => $accession->getAccession()));
        
        if( !$entity ) {        
            //create new accession           
            $em = $this->_em;
            $em->persist($accession);
            $em->flush();
            
            return $accession;
        } 
        
        return $entity;
    }
    
}
?>
